<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lotomania - Gerador Manual + Minimalista</title>
    <link rel="stylesheet" href="../css/styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        lotomania: '#E68527',
                        'lotomania-light': '#ea9948',
                        'lotomania-dark': '#cd7318',
                        'lotomania-bg': '#fcf2e8'
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        .loading-circle {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #E68527, #ea9948, #cd7318);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .numero-btn {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #E68527, #ea9948);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
            margin: 1px;
        }
        
        .numero-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(230, 133, 39, 0.4);
        }
        
        .numero-btn.selecionado {
            background: linear-gradient(135deg, #dc2626, #ef4444);
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.3);
            border-color: #dc2626;
        }
        
        .numero-btn.disabled {
            background: #9ca3af;
            cursor: not-allowed;
            opacity: 0.5;
        }
        
        .numero-btn.sorteado {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            border: 2px solid #fbbf24;
            position: relative;
        }
        
        .numero-btn.sorteado::after {
            content: "üéØ";
            position: absolute;
            top: -6px;
            right: -6px;
            font-size: 8px;
        }

        .numero-btn.espelho {
            background: linear-gradient(135deg, #8b5cf6, #a78bfa) !important;
            border: 2px solid #7c3aed !important;
            box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.3) !important;
        }

        .numero-btn.espelho::after {
            content: "ü™û";
            position: absolute;
            top: -6px;
            right: -6px;
            font-size: 8px;
        }

        .contador-destaque {
            animation: bounce 1s ease-in-out;
        }
        
        .meta-atingida {
            background: linear-gradient(45deg, #10b981, #34d399) !important;
            color: white;
            animation: pulse 1s infinite;
        }
        
        .meta-excedida {
            background: linear-gradient(45deg, #ef4444, #f87171) !important;
            color: white;
            animation: pulse 0.5s infinite;
        }

        .drop-zone {
            min-height: 120px;
            border: 3px dashed #E68527;
            border-radius: 12px;
            background: linear-gradient(135deg, #fcf2e8, #fae6d1);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: #E68527;
            font-weight: bold;
            transition: all 0.3s;
            position: relative;
        }

        .drop-zone.drag-over {
            background: linear-gradient(135deg, #fae6d1, #f7d9bb);
            border-color: #cd7318;
            transform: scale(1.02);
        }

        .drop-zone.has-numbers {
            background: linear-gradient(to right, #fcf2e8, #fae6d1);
            border-style: solid;
            padding: 16px;
        }

        .numero-drop {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #E68527, #ea9948);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 11px;
            margin: 1px;
            position: relative;
        }

        .numero-drop .remove-btn {
            position: absolute;
            top: -6px;
            right: -6px;
            background: #dc2626;
            color: white;
            border-radius: 50%;
            width: 14px;
            height: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .numero-drop:hover .remove-btn {
            opacity: 1;
        }
        
        .jogo-card {
            background: linear-gradient(to right, #fcf2e8, #fae6d1);
            border: 2px solid #E68527;
            border-radius: 12px;
            padding: 16px;
            margin: 8px 0;
        }
        
        .numero-jogo {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #E68527, #ea9948);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 11px;
            margin: 1px;
        }
        
        .custo-total {
            background: linear-gradient(45deg, #E68527, #cd7318);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 18px;
        }

        .palpite-card {
            background: linear-gradient(135deg, #fcf2e8, #fae6d1);
            border: 2px solid #E68527;
            border-radius: 12px;
            padding: 12px;
            margin: 8px 0;
        }

        .numero-palpite {
            width: 25px;
            height: 25px;
            background: linear-gradient(135deg, #E68527, #ea9948);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 10px;
            margin: 1px;
        }

        .logo {
            max-height: 60px;
            width: auto;
        }

        .sorteio-header {
            background: linear-gradient(135deg, #E68527, #cd7318);
            color: white;
            font-weight: bold;
            text-align: center;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
        }

        @media (max-width: 768px) {
            .numero-btn { width: 35px; height: 35px; font-size: 10px; }
            .numero-drop { width: 25px; height: 25px; font-size: 9px; }
        }
    </style>
</head>
<body class="bg-lotomania-bg min-h-screen">
    <div class="container mx-auto px-4 py-6">
        <!-- Header -->
        <div class="text-center mb-6">
            <img src="https://i.postimg.cc/BbM7Dk88/lotomania.png" alt="Lotomania Logo" class="logo mx-auto mb-4">
            <p class="text-gray-600">Gerador Completo: Manual + Minimalista com 19 Regras Avan√ßadas</p>
            <div class="flex justify-center gap-4 mt-4 text-sm">
                <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full">üîç An√°lise dos D√≠gitos</span>
                <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full">üîÑ Resultados Alterados</span>
                <span class="bg-orange-100 text-orange-800 px-3 py-1 rounded-full">üéØ 50 N√∫meros</span>
            </div>
        </div>

        <!-- Configura√ß√£o Principal -->
        <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-lotomania mb-6">
            <h2 class="text-2xl font-bold text-lotomania mb-4">‚öôÔ∏è CONFIGURA√á√ÉO PRINCIPAL</h2>
            <div class="bg-gradient-to-r from-lotomania-bg to-orange-50 p-4 rounded-lg border-2 border-lotomania">
                <h3 class="text-lg font-bold text-lotomania mb-3">‚öôÔ∏è CONFIGURA√á√ÉO PRINCIPAL - VALORES DA LOTOMANIA</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-4 rounded-lg border border-lotomania">
                        <div class="mb-3">
                            <label class="block text-lotomania font-bold mb-2">üí∞ Valor da Aposta (50 n√∫meros):</label>
                            <div class="flex items-center gap-2">
                                <span class="text-lg">R$</span>
                                <input type="number" id="valorAposta" value="3.00" step="0.01" min="0.01" 
                                       class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-base font-bold text-lotomania">
                                <button id="atualizarValor" class="bg-lotomania hover:bg-lotomania-dark text-white px-4 py-2 rounded-lg">
                                    üîÑ Atualizar
                                </button>
                            </div>
                            <div class="text-sm text-gray-600 mt-1">
                                <strong>Padr√£o oficial:</strong> R$ 3,00 (CEF)
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="text-sm font-medium text-lotomania mb-2">üìä Sistema Simplificado:</div>
                            <div class="text-sm text-gray-700 space-y-1">
                                <div><strong>50 n√∫meros:</strong> R$ <span id="valor50numeros">2,50</span></div>
                                <div class="text-xs text-gray-600">Valor fixo por jogo na Lotomania</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white p-4 rounded-lg border border-lotomania">
                        <div class="mb-3">
                            <div class="text-sm font-medium text-lotomania mb-2">üí° Status do Sistema:</div>
                            <div class="text-sm text-green-600 font-bold">‚úÖ Sistema configurado</div>
                            <div class="text-xs text-gray-600">√öltima atualiza√ß√£o: <span id="ultimaAtualizacao">-</span></div>
                            <div class="text-xs text-gray-600">Total de se√ß√µes: <strong>3</strong> (Manual + Minimalista + An√°lise)</div>
                        </div>
                        
                        <div class="bg-blue-50 p-3 rounded-lg">
                            <div class="text-sm font-medium text-blue-800 mb-1">üîß Como funciona:</div>
                            <div class="text-xs text-blue-700">
                                A Lotomania tem valor fixo de R$ 3,00 por jogo (50 n√∫meros de 00 a 99). 
                                O sistema atualiza automaticamente todas as se√ß√µes de gera√ß√£o.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Loading -->
        <div id="loading" class="text-center py-8">
            <div class="loading-circle mx-auto mb-4"></div>
            <p class="text-lotomania font-medium">üîç Carregando √∫ltimo resultado da Lotomania...</p>
        </div>

        <!-- √öltimo Resultado -->
        <div id="ultimoResultado" class="hidden mb-6">
            <div class="bg-white rounded-lg shadow-lg overflow-hidden border-2 border-lotomania">
                <div class="bg-lotomania text-white p-4 text-center">
                    <h2 id="tituloResultado" class="text-xl font-bold">Concurso</h2>
                    <div id="dataResultado" class="text-sm">üìÖ Data do sorteio</div>
                </div>
                
                <div class="p-6">
                    <!-- N√∫meros Sorteados -->
                    <div class="mb-6">
                        <div class="sorteio-header">üéØ N√öMEROS SORTEADOS</div>
                        <div class="flex justify-center gap-1 flex-wrap">
                            <div id="numerosSorteados" class="flex justify-center gap-1 flex-wrap">
                                <!-- N√∫meros sorteados ser√£o inseridos aqui -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <div class="text-sm text-gray-600">Pr√≥ximo Sorteio: <span id="proximoConcurso">Concurso</span></div>
                        <div class="text-sm text-gray-600" id="dataProximoConcurso">Data</div>
                        <div class="text-2xl font-bold text-lotomania mt-2" id="premioEstimado">Pr√™mio Estimado</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interface Principal -->
        <div id="interfacePrincipal" class="hidden space-y-6">
            
            <!-- SE√á√ÉO 1: CRIA√á√ÉO MANUAL DE JOGOS -->
            <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-lotomania">
                <h2 class="text-2xl font-bold text-lotomania mb-6">üéÆ SE√á√ÉO 1: CRIA√á√ÉO MANUAL DE JOGOS</h2>

                <!-- Estrat√©gia da Lotomania -->
                <div class="mb-6 p-5 bg-gradient-to-br from-orange-50 via-yellow-50 to-red-50 border-4 border-orange-400 rounded-xl shadow-lg">
                    <div class="text-xl font-bold text-gray-800 mb-4 text-center">üü† ESTRAT√âGIA: LOTOMANIA</div>
                    
                    <div id="padraoHistorico" class="mb-4 p-4 bg-gradient-to-r from-orange-50 to-yellow-50 border-2 border-orange-300 rounded-lg text-center">
                        <div class="text-sm font-bold text-orange-800 mb-2">üèÜ SISTEMA √öNICO:</div>
                        <div class="text-2xl font-bold text-orange-900 mb-1">
                            <span class="text-orange-600">50</span> n√∫meros selecionados
                        </div>
                        <div class="text-sm text-orange-700">
                            De 00 a 99 (100 n√∫meros dispon√≠veis)
                        </div>
                    </div>

                    <div id="estatisticaUltimoSorteio" class="mb-4 p-3 bg-blue-100 border border-blue-300 rounded-lg text-center">
                        <div class="text-sm font-medium text-blue-800">üìä √öLTIMO SORTEIO:</div>
                        <div class="text-lg font-bold text-blue-900">
                            <span id="numerosUltimoSorteio" class="text-orange-600">20</span> n√∫meros sorteados
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-6 mb-4">
                        <div class="text-center p-4 bg-orange-100 rounded-lg border-2 border-orange-300">
                            <div class="text-4xl font-bold text-orange-600 contador-destaque" id="numerosAtuais">0</div>
                            <div class="text-lg font-bold text-orange-700">SELECIONADOS</div>
                            <div class="text-sm text-orange-600">üéØ Meta: <span id="metaNumeros" class="font-bold">50</span></div>
                        </div>
                        <div class="text-center p-4 bg-yellow-100 rounded-lg border-2 border-yellow-300">
                            <div class="text-4xl font-bold text-yellow-600 contador-destaque" id="restantesAtuais">100</div>
                            <div class="text-lg font-bold text-yellow-700">RESTANTES</div>
                            <div class="text-sm text-yellow-600">üìä Dispon√≠veis para sele√ß√£o</div>
                        </div>
                    </div>
                    
                    <div id="statusEstrategia" class="text-center p-3 rounded-lg font-bold text-lg bg-gray-100 text-gray-700">
                        üéØ Selecione 50 n√∫meros para completar sua aposta
                    </div>
                </div>

                <!-- Op√ß√£o Aposta Espelho -->
                <div class="mb-6 p-4 bg-purple-50 border border-purple-200 rounded-lg">
                    <div class="flex items-center justify-between mb-3">
                        <div>
                            <div class="text-lg font-bold text-purple-800">ü™û APOSTA ESPELHO</div>
                            <div class="text-sm text-purple-600">Visualize os outros 50 n√∫meros (n√£o selecionados)</div>
                        </div>
                        <div class="flex gap-2">
                            <button id="mostrarApostaEspelho" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg text-sm">
                                üëÅÔ∏è Ver Espelho
                            </button>
                            <button id="alternarParaEspelho" class="bg-purple-700 hover:bg-purple-800 text-white px-4 py-2 rounded-lg text-sm">
                                üîÑ Trocar
                            </button>
                        </div>
                    </div>
                    <div class="text-xs text-purple-600">
                        üí° <strong>"Ver Espelho":</strong> Mostra os outros 50 n√∫meros em roxo no grid<br>
                        üí° <strong>"Trocar":</strong> Inverte sele√ß√£o (50 selecionados ‚Üî 50 espelho)
                    </div>
                </div>

                <!-- Controle de N√∫meros Sorteados -->
                <div id="controleNumerosSorteados" class="mb-4 p-3 bg-orange-50 border border-orange-200 rounded-lg hidden">
                    <div class="flex justify-between items-center mb-2">
                        <div class="text-sm font-medium text-orange-800">
                            üéØ N√∫meros j√° sorteados: <span id="numerosSorteadosLista" class="font-bold"></span>
                        </div>
                        <label class="flex items-center text-sm">
                            <input type="checkbox" id="permitirNumerosSorteados" class="mr-2">
                            <span class="text-orange-700">üîì Permitir usar n√∫meros j√° sorteados</span>
                        </label>
                    </div>
                </div>

                <!-- Inser√ß√£o Manual -->
                <div class="mb-6">
                    <label class="block text-lotomania font-medium mb-2">‚úèÔ∏è Inser√ß√£o Manual de N√∫meros:</label>
                    <div class="flex gap-2">
                        <textarea 
                            id="insertionManual" 
                            class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-lotomania text-base resize-none" 
                            placeholder="Exemplos:&#10;01 15 23 34 45 50 67 78 89 99...&#10;05 12 18 22 24 30 41 52 63 74...&#10;Digite at√© 50 n√∫meros de 00 a 99"
                            rows="3"
                        ></textarea>
                        <button id="processarManual" class="bg-lotomania hover:bg-lotomania-dark text-white px-4 py-2 rounded-lg">
                            üìù Processar
                        </button>
                    </div>
                    <div class="text-xs text-gray-600 mt-1">üí° Dica: Cole n√∫meros de qualquer formato (50 n√∫meros)</div>
                </div>

                <!-- Grid de N√∫meros -->
                <div class="mb-6">
                    <label class="block text-lotomania font-medium mb-2">Selecione 50 N√∫meros (00-99):</label>
                    <div class="text-xs mb-2 text-gray-600">
                        <span class="text-orange-600">üü†</span> Laranja = Dispon√≠vel | 
                        <span class="text-red-600">üî¥</span> Vermelho = Selecionado | 
                        <span class="text-yellow-600">üéØ</span> J√° sorteados
                    </div>
                    <div id="gridNumeros" class="grid grid-cols-10 gap-1 mb-4 max-h-96 overflow-y-auto">
                        <!-- N√∫meros ser√£o gerados via JavaScript -->
                    </div>
                </div>

                <!-- √Årea de Drop -->
                <div class="mb-6">
                    <label class="block text-lotomania font-medium mb-2">üéØ N√∫meros Selecionados:</label>
                    <div id="dropZone" class="drop-zone">
                        <div id="dropMessage">
                            <div class="text-lg mb-2">üì• Arraste n√∫meros aqui ou clique nos n√∫meros acima</div>
                            <div class="text-sm">Os n√∫meros selecionados aparecer√£o aqui</div>
                        </div>
                        <div id="itemsDropped" class="hidden flex flex-wrap justify-center gap-1">
                            <!-- N√∫meros selecionados aparecer√£o aqui -->
                        </div>
                    </div>
                    <div class="flex justify-between items-center mt-2 text-xs text-gray-600">
                        <span>Meta: <strong>50 n√∫meros</strong></span>
                        <span>Atual: <span id="numerosNaArea" class="font-bold">0</span> n√∫meros</span>
                    </div>
                </div>

                <!-- Bot√µes de A√ß√£o -->
                <div class="flex flex-wrap gap-2">
                    <button id="limparJogo" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg">
                        üóëÔ∏è Limpar
                    </button>
                    <button id="randomizarJogo" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg">
                        üé≤ Aleat√≥rio
                    </button>
                    <button id="completarAutomatico" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">
                        üîÑ Completar 50
                    </button>
                    <button id="adicionarJogo" class="bg-lotomania hover:bg-lotomania-dark text-white px-4 py-2 rounded-lg disabled:opacity-50" disabled>
                        ‚ûï Adicionar Jogo
                    </button>
                </div>
            </div>

            <!-- SE√á√ÉO 2: GERA√á√ÉO MINIMALISTA -->
            <div class="bg-white rounded-lg shadow-lg p-6 border-4 border-green-400">
                <h2 class="text-2xl font-bold text-green-600 mb-6">üßÆ SE√á√ÉO 2: GERA√á√ÉO MINIMALISTA</h2>

                <!-- Dados do Pr√≥ximo Sorteio -->
                <div class="bg-gradient-to-r from-blue-50 via-green-50 to-yellow-50 p-4 rounded-lg border-2 border-blue-200 mb-6">
                    <h3 class="text-lg font-bold text-blue-800 mb-3">üìä Dados do Pr√≥ximo Sorteio</h3>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div class="text-center">
                            <div class="text-sm font-medium text-blue-800">üéØ Concurso:</div>
                            <div id="concursoNum" class="text-lg font-bold text-blue-900">Loading...</div>
                        </div>
                        <div class="text-center">
                            <div class="text-sm font-medium text-green-800">üìÖ Data:</div>
                            <div id="dataProximo" class="text-lg font-bold text-green-900">Loading...</div>
                        </div>
                        <div class="text-center">
                            <div class="text-sm font-medium text-yellow-800">üí∞ Pr√™mio:</div>
                            <div id="premioProximo" class="text-lg font-bold text-yellow-900">Loading...</div>
                        </div>
                        <div class="text-center">
                            <div class="text-sm font-medium text-purple-800">üìà Status:</div>
                            <div id="statusConcurso" class="text-lg font-bold text-purple-900">Carregando...</div>
                        </div>
                    </div>
                </div>

                <!-- Configura√ß√µes e Gera√ß√£o -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <h3 class="text-lg font-bold text-gray-800 mb-3">‚öôÔ∏è Configura√ß√µes:</h3>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Quantidade:</label>
                                <select id="quantidadeJogos" class="w-full px-3 py-2 border border-gray-300 rounded text-base">
                                    <option value="3">3 jogos</option>
                                    <option value="5" selected>5 jogos</option>
                                    <option value="7">7 jogos</option>
                                    <option value="10">10 jogos</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">N√∫meros:</label>
                                <select id="quantidadeNumeros" class="w-full px-3 py-2 border border-gray-300 rounded text-base">
                                    <option value="50" selected>50 n√∫meros</option>
                                </select>
                                <div class="text-xs text-gray-600 mt-1">Lotomania: sempre 50 n√∫meros de 00 a 99</div>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">üéØ Estrat√©gia:</label>
                                <select id="estrategiaGeracao" class="w-full px-3 py-2 border border-gray-300 rounded text-base">
                                    <option value="equilibrada" selected>üéØ Equilibrada</option>
                                    <option value="aleatoria">üé≤ Totalmente Aleat√≥rio</option>
                                    <option value="evitar-sorteados">üìä Evitar Sorteados</option>
                                    <option value="incluir-sorteados">üìä Incluir Sorteados</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <!-- Bot√£o de Gera√ß√£o -->
                        <button id="gerarMinimalistas" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-6 rounded-lg text-lg">
                            üöÄ Gerar Jogos Minimalistas
                        </button>

                        <!-- Status da Gera√ß√£o -->
                        <div id="statusGeracao" class="hidden bg-blue-50 p-3 rounded-lg border border-blue-200">
                            <div class="text-sm font-medium text-blue-800">üîÑ Gerando jogos com regras minimalistas...</div>
                        </div>
                    </div>
                </div>

                <!-- Resultados -->
                <div id="resultadosMinimalistas" class="hidden">
                    <div class="bg-green-50 p-4 rounded-lg border border-green-200 mb-4">
                        <h4 class="font-bold text-green-800 mb-2">üéØ Jogos Gerados:</h4>
                        <button id="adicionarTodosGerados" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg">
                            ‚ûï Adicionar Todos
                        </button>
                    </div>
                    
                    <div class="bg-white border border-gray-200 rounded-lg p-4 max-h-80 overflow-y-auto">
                        <div id="listaJogosGerados" class="space-y-2">
                            <!-- Jogos gerados aparecer√£o aqui -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- SE√á√ÉO 3: AN√ÅLISE DE PADR√ïES -->
            <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-blue-400">
                <h2 class="text-2xl font-bold text-blue-600 mb-6">üìä SE√á√ÉO 3: AN√ÅLISE DE PADR√ïES E N√öMEROS AUSENTES</h2>

                <!-- Padr√µes do √öltimo Concurso -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <div class="bg-orange-50 p-6 rounded-lg border border-orange-200">
                        <h3 class="text-xl font-bold text-orange-800 mb-4">üìà N√∫meros Sorteados (Ordem Crescente)</h3>
                        <div class="text-center">
                            <div id="numerosCrescente" class="text-sm font-bold text-gray-800 mb-3 flex flex-wrap justify-center gap-1">[Carregando...]</div>
                            <div id="resumoSorteados" class="text-base font-bold text-orange-800 mt-2">[Aguardando...]</div>
                            <div class="text-sm text-green-600 font-bold mt-2">‚úÖ 20 n√∫meros sorteados</div>
                        </div>
                    </div>
                    
                    <div class="bg-blue-50 p-6 rounded-lg border border-blue-200">
                        <h3 class="text-xl font-bold text-blue-800 mb-4">üéØ N√∫meros Sorteados (Ordem de Sorteio)</h3>
                        <div class="text-center">
                            <div id="numerosSorteio" class="text-sm font-bold text-gray-800 mb-3 flex flex-wrap justify-center gap-1">[Carregando...]</div>
                            <div id="resumoSorteio" class="text-base font-bold text-blue-800 mt-2">[Aguardando...]</div>
                            <div class="text-sm text-green-600 font-bold mt-2">‚úÖ Ordem original do sorteio</div>
                        </div>
                    </div>
                </div>

                <!-- N√∫meros Ausentes -->
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 md:mb-0">üîç N√∫meros que N√ÉO Sa√≠ram</h3>
                        <div class="flex items-center gap-2">
                            <label class="text-sm font-medium text-gray-700">Analisar √∫ltimos:</label>
                            <select id="analisarJogos" class="px-3 py-2 border border-gray-300 rounded text-base font-medium">
                                <option value="3">3 jogos</option>
                                <option value="5">5 jogos</option>
                                <option value="6" selected>6 jogos</option>
                                <option value="7">7 jogos</option>
                                <option value="10">10 jogos</option>
                                <option value="15">15 jogos</option>
                                <option value="20">20 jogos</option>
                            </select>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <div class="bg-red-50 p-4 rounded-lg border-2 border-red-200 text-center">
                            <div class="text-sm font-bold text-red-800 mb-2">üî¥ 00-24</div>
                            <div id="numerosQ1" class="text-xs font-mono font-bold text-red-700 bg-white p-2 rounded min-h-[40px] flex items-center justify-center">...</div>
                        </div>
                        <div class="bg-yellow-50 p-4 rounded-lg border-2 border-yellow-200 text-center">
                            <div class="text-sm font-bold text-yellow-800 mb-2">üü° 25-49</div>
                            <div id="numerosQ2" class="text-xs font-mono font-bold text-yellow-700 bg-white p-2 rounded min-h-[40px] flex items-center justify-center">...</div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg border-2 border-green-200 text-center">
                            <div class="text-sm font-bold text-green-800 mb-2">üü¢ 50-74</div>
                            <div id="numerosQ3" class="text-xs font-mono font-bold text-green-700 bg-white p-2 rounded min-h-[40px] flex items-center justify-center">...</div>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg border-2 border-purple-200 text-center">
                            <div class="text-sm font-bold text-purple-800 mb-2">üü£ 75-99</div>
                            <div id="numerosQ4" class="text-xs font-mono font-bold text-purple-700 bg-white p-2 rounded min-h-[40px] flex items-center justify-center">...</div>
                        </div>
                    </div>

                    <div class="bg-gray-100 p-4 rounded-lg border-2 border-gray-300 text-center">
                        <div class="text-lg font-bold text-gray-800 mb-2">üìä RESUMO ESTAT√çSTICO</div>
                        <div id="resumoAnalise" class="text-base font-medium text-gray-700">Aguardando an√°lise...</div>
                    </div>
                </div>
            </div>

            <!-- SE√á√ÉO: MEUS JOGOS -->
            <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-lotomania">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold text-lotomania">üìã MEUS JOGOS</h2>
                    <label class="flex items-center text-sm">
                        <input type="checkbox" id="mostrarOrdemCrescente" class="mr-2" checked>
                        üî¢ Ordem Crescente
                    </label>
                </div>

                <!-- Custo Total -->
                <div class="mb-4">
                    <div class="custo-total text-center">
                        üí∞ Total: <span id="custoTotal">R$ 0,00</span>
                    </div>
                    <div class="text-center text-sm text-gray-600 mt-2">
                        <span id="totalJogos">0</span> jogo(s) adicionado(s)
                    </div>
                </div>

                <!-- Bot√µes de Download -->
                <div class="grid grid-cols-3 gap-2 mb-4">
                    <button id="downloadHTML" class="bg-orange-500 hover:bg-orange-600 text-white px-3 py-2 rounded-lg text-sm">
                        üåê HTML
                    </button>
                    <button id="downloadTXT" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm">
                        üìÑ TXT
                    </button>
                    <button id="downloadXLSX" class="bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded-lg text-sm">
                        üìä XLSX
                    </button>
                </div>

                <!-- Bot√£o Limpar -->
                <button id="limparTodos" class="w-full bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg mb-4">
                    üóëÔ∏è Limpar
                </button>

                <!-- Lista dos Jogos -->
                <div class="bg-gray-50 rounded-lg p-4 max-h-96 overflow-y-auto">
                    <h4 class="font-bold text-gray-800 mb-4">Lista de Jogos:</h4>
                    <div id="listaJogos">
                        <p class="text-gray-500 text-center py-8">Nenhum jogo adicionado ainda</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="../js/scripts.js"></script>
    <script>
        // üéØ CONFIGURA√á√ïES E DADOS DA LOTOMANIA
        const DADOS_EXEMPLO = {
            ultimoResultado: {
                numero: 2805,
                dataApuracao: "04/08/2025",
                dataProximoConcurso: "06/08/2025",
                listaDezenas: ["01", "03", "04", "12", "13", "14", "15", "27", "33", "40", "43", "47", "52", "58", "60", "68", "77", "81", "91", "94"],
                dezenasSorteadasOrdemSorteio: ["81", "01", "77", "52", "33", "27", "14", "47", "13", "91", "94", "04", "60", "03", "12", "43", "68", "40", "15", "58"],
                acumulado: true,
                valorEstimadoProximoConcurso: 1400000.00
            }
        };

        // Vari√°veis globais
        let ultimoResultado = null;
        let jogosAdicionados = [];
        let numerosSelecionados = [];
        let numerosSorteados = new Set();
        let valorAposta = 3.00;

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                await carregarUltimoResultado();
            } catch (error) {
                console.log('Usando dados de exemplo');
                usarDadosExemplo();
            }
            
            inicializarInterface();
            configurarEventListeners();
        });

        async function carregarUltimoResultado() {
            try {
                const response = await fetch('https://servicebus2.caixa.gov.br/portaldeloterias/api/lotomania');
                if (response.ok) {
                    const data = await response.json();
                    if (data && data.numero) {
                        ultimoResultado = data;
                        exibirUltimoResultado(data);
                        finalizarCarregamento();
                        return;
                    }
                }
                throw new Error('API indispon√≠vel');
            } catch (error) {
                throw error;
            }
        }

        function usarDadosExemplo() {
            ultimoResultado = DADOS_EXEMPLO.ultimoResultado;
            exibirUltimoResultado(ultimoResultado);
            finalizarCarregamento();
        }

        function finalizarCarregamento() {
            document.getElementById('loading').classList.add('hidden');
            document.getElementById('ultimoResultado').classList.remove('hidden');
            document.getElementById('interfacePrincipal').classList.remove('hidden');
            
            // Carregar an√°lise de padr√µes
            setTimeout(() => {
                carregarAnalisesPadroes();
            }, 1000);
        }

        function exibirUltimoResultado(data) {
            document.getElementById('tituloResultado').textContent = `Concurso ${data.numero}`;
            document.getElementById('dataResultado').textContent = `üìÖ ${data.dataApuracao}`;
            document.getElementById('proximoConcurso').textContent = `Concurso ${data.numero + 1}`;
            document.getElementById('dataProximoConcurso').textContent = data.dataProximoConcurso || 'A definir';
            document.getElementById('premioEstimado').textContent = `Pr√™mio Estimado: ${formatarMoeda(data.valorEstimadoProximoConcurso || 1400000)}`;

            // Exibir n√∫meros sorteados
            const numerosSorteadosDiv = document.getElementById('numerosSorteados');
            numerosSorteadosDiv.innerHTML = '';
            data.listaDezenas.forEach(num => {
                const numeroEl = document.createElement('div');
                numeroEl.className = 'numero-jogo';
                numeroEl.textContent = num;
                numerosSorteadosDiv.appendChild(numeroEl);
            });

            // Atualizar dados da se√ß√£o minimalista
            document.getElementById('concursoNum').textContent = data.numero + 1;
            document.getElementById('dataProximo').textContent = data.dataProximoConcurso || 'A definir';
            document.getElementById('premioProximo').textContent = formatarMoeda(data.valorEstimadoProximoConcurso || 1400000);
            document.getElementById('statusConcurso').textContent = data.acumulado ? 'Acumulado' : 'Teve ganhador';
            document.getElementById('numerosUltimoSorteio').textContent = data.listaDezenas.length;

            identificarNumerosSorteados(data.listaDezenas);
        }

        function identificarNumerosSorteados(numeros) {
            numerosSorteados.clear();
            numeros.forEach(num => {
                numerosSorteados.add(parseInt(num));
            });
            
            if (numerosSorteados.size > 0) {
                exibirControleNumerosSorteados();
                atualizarEstadoNumerosSorteados();
            }
        }

        function exibirControleNumerosSorteados() {
            const controle = document.getElementById('controleNumerosSorteados');
            const lista = document.getElementById('numerosSorteadosLista');
            
            const numerosArray = Array.from(numerosSorteados).sort((a, b) => a - b);
            const numerosTexto = numerosArray.map(n => n.toString().padStart(2, '0')).join(', ');
            lista.textContent = numerosTexto;
            
            controle.classList.remove('hidden');
        }

        function atualizarEstadoNumerosSorteados() {
            const permitir = document.getElementById('permitirNumerosSorteados').checked;
            
            numerosSorteados.forEach(numero => {
                const btn = document.querySelector(`[data-numero="${numero}"]`);
                if (btn) {
                    btn.classList.add('sorteado');
                    if (!permitir) {
                        btn.classList.add('disabled');
                        btn.onclick = () => {
                            showCustomAlert('üéØ N√∫mero Sorteado', `O n√∫mero ${numero.toString().padStart(2, '0')} saiu nos √∫ltimos sorteios.`);
                        };
                    } else {
                        btn.classList.remove('disabled');
                        btn.onclick = () => toggleNumero(numero);
                    }
                }
            });
        }

        function inicializarInterface() {
            criarGridNumeros();
            atualizarContadorNumeros();
            atualizarVisualizacaoDropArea();
            atualizarValorAposta();
        }

        function criarGridNumeros() {
            const grid = document.getElementById('gridNumeros');
            grid.innerHTML = '';
            
            for (let i = 0; i <= 99; i++) {
                const btn = document.createElement('button');
                btn.className = 'numero-btn';
                btn.dataset.numero = i;
                btn.draggable = true;
                
                btn.textContent = i.toString().padStart(2, '0');
                btn.onclick = () => toggleNumero(i);
                
                // Event listeners para drag and drop
                btn.addEventListener('dragstart', handleDragStart);
                btn.addEventListener('dragend', handleDragEnd);
                
                grid.appendChild(btn);
            }
        }

        function toggleNumero(numero) {
            const btn = document.querySelector(`[data-numero="${numero}"]`);
            const apostaEspelho = document.getElementById('apostaEspelho').checked;
            
            if (numerosSelecionados.includes(numero)) {
                numerosSelecionados = numerosSelecionados.filter(n => n !== numero);
                btn.classList.remove('selecionado');
            } else if (numerosSelecionados.length < 50) {
                numerosSelecionados.push(numero);
                btn.classList.add('selecionado');
            }
            
            // Se aposta espelho estiver ativada e j√° temos 50 n√∫meros, aplicar automaticamente
            if (apostaEspelho && numerosSelecionados.length === 50) {
                aplicarApostaEspelho();
            }
            
            atualizarVisualizacaoDropArea();
            atualizarContadorNumeros();
            validarBotaoAdicionar();
        }

        function aplicarApostaEspelho() {
            // Limpar sele√ß√£o atual
            numerosSelecionados = [];
            document.querySelectorAll('.numero-btn').forEach(btn => {
                btn.classList.remove('selecionado');
            });
            
            // Selecionar n√∫meros N√ÉO selecionados anteriormente
            for (let i = 0; i <= 99; i++) {
                if (!numerosSelecionados.includes(i)) {
                    numerosSelecionados.push(i);
                    const btn = document.querySelector(`[data-numero="${i}"]`);
                    btn.classList.add('selecionado');
                    
                    if (numerosSelecionados.length === 50) break;
                }
            }
        }

        function atualizarVisualizacaoDropArea() {
            const dropZone = document.getElementById('dropZone');
            const dropMessage = document.getElementById('dropMessage');
            const itemsDropped = document.getElementById('itemsDropped');
            const numerosNaArea = document.getElementById('numerosNaArea');
            
            numerosNaArea.textContent = numerosSelecionados.length;
            
            if (numerosSelecionados.length === 0) {
                dropZone.classList.remove('has-numbers');
                dropMessage.classList.remove('hidden');
                itemsDropped.classList.add('hidden');
            } else {
                dropZone.classList.add('has-numbers');
                dropMessage.classList.add('hidden');
                itemsDropped.classList.remove('hidden');
                
                let html = '';
                
                // Mostrar primeiros n√∫meros (limitado para n√£o sobrecarregar)
                const numerosParaExibir = numerosSelecionados.slice(0, 25).sort((a, b) => a - b);
                numerosParaExibir.forEach(numero => {
                    html += `
                        <div class="numero-drop">
                            ${numero.toString().padStart(2, '0')}
                            <div class="remove-btn" onclick="removerNumeroDropArea(${numero})">√ó</div>
                        </div>
                    `;
                });
                
                if (numerosSelecionados.length > 25) {
                    html += `<div class="text-xs text-gray-600 p-2">... e mais ${numerosSelecionados.length - 25} n√∫meros</div>`;
                }
                
                itemsDropped.innerHTML = html;
            }
        }

        function removerNumeroDropArea(numero) {
            numerosSelecionados = numerosSelecionados.filter(n => n !== numero);
            const btn = document.querySelector(`[data-numero="${numero}"]`);
            if (btn) btn.classList.remove('selecionado');
            
            atualizarVisualizacaoDropArea();
            atualizarContadorNumeros();
            validarBotaoAdicionar();
        }

        function atualizarContadorNumeros() {
            const numerosAtuais = numerosSelecionados.length;
            const restantes = 100 - numerosAtuais;
            
            document.getElementById('numerosAtuais').textContent = numerosAtuais;
            document.getElementById('restantesAtuais').textContent = restantes;
            
            const statusEl = document.getElementById('statusEstrategia');
            
            if (numerosAtuais === 0) {
                statusEl.textContent = 'üéØ Selecione 50 n√∫meros para completar sua aposta';
                statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-gray-100 text-gray-700';
            } else if (numerosAtuais < 50) {
                const faltam = 50 - numerosAtuais;
                statusEl.textContent = `üìç Faltam ${faltam} n√∫meros para completar sua aposta`;
                statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-blue-100 text-blue-800';
            } else if (numerosAtuais === 50) {
                statusEl.textContent = '‚úÖ APOSTA COMPLETA! 50 n√∫meros selecionados';
                statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-green-200 text-green-800 meta-atingida';
            } else {
                statusEl.textContent = '‚ö†Ô∏è Mais de 50 n√∫meros selecionados! Remova alguns n√∫meros.';
                statusEl.className = 'text-center p-3 rounded-lg font-bold text-lg bg-red-100 text-red-800 meta-excedida';
            }
        }

        function validarBotaoAdicionar() {
            const btn = document.getElementById('adicionarJogo');
            btn.disabled = numerosSelecionados.length !== 50;
        }

        function limparJogo() {
            numerosSelecionados = [];
            
            document.querySelectorAll('.numero-btn').forEach(btn => {
                btn.classList.remove('selecionado');
            });
            
            atualizarVisualizacaoDropArea();
            atualizarContadorNumeros();
            validarBotaoAdicionar();
        }

        function randomizarJogo() {
            limparJogo();
            
            const permiteSorteados = document.getElementById('permitirNumerosSorteados').checked;
            const numerosDisponiveis = Array.from({length: 100}, (_, i) => i).filter(num => {
                return permiteSorteados || !numerosSorteados.has(num);
            });
            
            // Selecionar 50 n√∫meros aleat√≥rios
            while (numerosSelecionados.length < 50 && numerosDisponiveis.length > 0) {
                const index = Math.floor(Math.random() * numerosDisponiveis.length);
                const numero = numerosDisponiveis.splice(index, 1)[0];
                numerosSelecionados.push(numero);
                
                const btn = document.querySelector(`[data-numero="${numero}"]`);
                btn.classList.add('selecionado');
            }
            
            atualizarVisualizacaoDropArea();
            atualizarContadorNumeros();
            validarBotaoAdicionar();
        }

        function completarAutomatico() {
            const permiteSorteados = document.getElementById('permitirNumerosSorteados').checked;
            const numerosDisponiveis = Array.from({length: 100}, (_, i) => i).filter(num => {
                return !numerosSelecionados.includes(num) && (permiteSorteados || !numerosSorteados.has(num));
            });
            
            while (numerosSelecionados.length < 50 && numerosDisponiveis.length > 0) {
                const index = Math.floor(Math.random() * numerosDisponiveis.length);
                const numero = numerosDisponiveis.splice(index, 1)[0];
                numerosSelecionados.push(numero);
                
                const btn = document.querySelector(`[data-numero="${numero}"]`);
                btn.classList.add('selecionado');
            }
            
            atualizarVisualizacaoDropArea();
            atualizarContadorNumeros();
            validarBotaoAdicionar();
        }

        function adicionarJogo() {
            const jogo = {
                id: Date.now(),
                numeros: [...numerosSelecionados].sort((a, b) => a - b),
                custo: valorAposta,
                apostaEspelho: document.getElementById('apostaEspelho').checked
            };
            
            jogosAdicionados.push(jogo);
            limparJogo();
            atualizarVisualizacaoJogos();
            atualizarCustoTotal();
        }

        // Processamento Manual de N√∫meros
        function processarManual() {
            const input = document.getElementById('insertionManual');
            const texto = input.value.trim();
            
            if (!texto) {
                showCustomAlert('‚ö†Ô∏è Campo Vazio', 'Digite alguns n√∫meros primeiro!');
                return;
            }
            
            const partes = texto.split(/[\s,;-]+/);
            const numerosTexto = [];
            
            partes.forEach(parte => {
                if (parte.match(/^\d+$/)) {
                    const num = parseInt(parte);
                    if (num >= 0 && num <= 99) {
                        numerosTexto.push(num);
                    }
                }
            });
            
            if (numerosTexto.length === 0) {
                showCustomAlert('‚ùå Erro', 'Nenhum n√∫mero v√°lido encontrado!');
                return;
            }
            
            if (numerosTexto.length > 50) {
                showCustomAlert('‚ùå Erro', `Muitos n√∫meros! M√°ximo 50, encontrados: ${numerosTexto.length}`);
                return;
            }
            
            const numerosUnicos = [...new Set(numerosTexto)];
            if (numerosUnicos.length !== numerosTexto.length) {
                showCustomAlert('‚ö†Ô∏è Aviso', 'N√∫meros duplicados foram removidos.');
            }
            
            limparJogo();
            
            // Aplicar n√∫meros
            numerosUnicos.forEach(numero => {
                numerosSelecionados.push(numero);
                const btn = document.querySelector(`[data-numero="${numero}"]`);
                if (btn) btn.classList.add('selecionado');
            });
            
            document.getElementById('insertionManual').value = '';
            
            atualizarVisualizacaoDropArea();
            atualizarContadorNumeros();
            validarBotaoAdicionar();
            
            showCustomAlert('‚úÖ Sucesso', `${numerosUnicos.length} n√∫meros aplicados!`);
        }

        // Gera√ß√£o Minimalista
        function gerarMinimalistas() {
            const quantidade = parseInt(document.getElementById('quantidadeJogos').value);
            const estrategia = document.getElementById('estrategiaGeracao').value;
            
            const jogosGerados = [];
            
            for (let i = 0; i < quantidade; i++) {
                const jogo = gerarJogoMinimalista(estrategia);
                if (jogo) {
                    jogosGerados.push(jogo);
                }
            }
            
            exibirJogosGerados(jogosGerados);
        }

        function gerarJogoMinimalista(estrategia) {
            let numerosDisponiveis = Array.from({length: 100}, (_, i) => i);
            
            if (estrategia === 'evitar-sorteados') {
                numerosDisponiveis = numerosDisponiveis.filter(n => !numerosSorteados.has(n));
            }
            
            const numeros = [];
            
            // Selecionar 50 n√∫meros
            while (numeros.length < 50 && numerosDisponiveis.length > 0) {
                const index = Math.floor(Math.random() * numerosDisponiveis.length);
                numeros.push(numerosDisponiveis.splice(index, 1)[0]);
            }
            
            if (numeros.length === 50) {
                return {
                    id: Date.now() + Math.random(),
                    numeros: numeros.sort((a, b) => a - b),
                    custo: valorAposta,
                    origem: 'Gera√ß√£o Minimalista'
                };
            }
            
            return null;
        }

        function exibirJogosGerados(jogos) {
            const container = document.getElementById('resultadosMinimalistas');
            const lista = document.getElementById('listaJogosGerados');
            
            lista.innerHTML = '';
            
            if (jogos.length === 0) {
                lista.innerHTML = '<p class="text-gray-500 text-center py-4">Nenhum jogo foi gerado</p>';
                container.classList.remove('hidden');
                return;
            }
            
            jogos.forEach((jogo, index) => {
                const jogoDiv = document.createElement('div');
                jogoDiv.className = 'palpite-card';
                
                jogoDiv.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-bold text-green-600">Jogo ${index + 1}</span>
                        <div class="text-xs text-gray-600">
                            50 n√∫meros
                        </div>
                    </div>
                    <div class="flex items-center gap-1">
                        <div class="flex flex-wrap gap-1">
                            ${jogo.numeros.slice(0, 20).map(num => 
                                `<div class="numero-palpite">${num.toString().padStart(2, '0')}</div>`
                            ).join('')}
                        </div>
                    </div>
                    <div class="text-xs text-gray-600 mt-1">... e mais ${jogo.numeros.length - 20} n√∫meros</div>
                `;
                
                lista.appendChild(jogoDiv);
            });
            
            window.jogosGerados = jogos;
            container.classList.remove('hidden');
        }

        function adicionarTodosGerados() {
            if (window.jogosGerados) {
                window.jogosGerados.forEach(jogo => {
                    jogosAdicionados.push(jogo);
                });
                
                atualizarVisualizacaoJogos();
                atualizarCustoTotal();
                showCustomAlert('‚úÖ Sucesso', `${window.jogosGerados.length} jogos adicionados!`);
            }
        }

        function atualizarVisualizacaoJogos() {
            const lista = document.getElementById('listaJogos');
            const ordemCrescente = document.getElementById('mostrarOrdemCrescente').checked;
            
            if (jogosAdicionados.length === 0) {
                lista.innerHTML = '<p class="text-gray-500 text-center py-8">Nenhum jogo adicionado ainda</p>';
                return;
            }
            
            lista.innerHTML = '';
            jogosAdicionados.forEach((jogo, index) => {
                const jogoDiv = document.createElement('div');
                jogoDiv.className = 'jogo-card';
                
                const numerosOrdenados = ordemCrescente ? 
                    [...jogo.numeros].sort((a, b) => a - b) : 
                    jogo.numeros;
                
                jogoDiv.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-bold text-lotomania">Jogo ${index + 1}</span>
                        <div class="flex gap-2">
                            <span class="px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded">50N</span>
                            ${jogo.apostaEspelho ? '<span class="px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded">ü™û</span>' : ''}
                            <button onclick="removerJogo(${jogo.id})" class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs">
                                üóëÔ∏è
                            </button>
                        </div>
                    </div>
                    <div class="flex items-center gap-1 mb-2">
                        <div class="flex flex-wrap gap-1">
                            ${numerosOrdenados.slice(0, 25).map(num => 
                                `<div class="numero-jogo">${num.toString().padStart(2, '0')}</div>`
                            ).join('')}
                        </div>
                    </div>
                    <div class="text-xs text-gray-600 mb-2">... e mais ${jogo.numeros.length - 25} n√∫meros</div>
                    <div class="text-sm text-gray-600">
                        50 n√∫meros - ${formatarMoeda(jogo.custo)}
                        ${jogo.origem ? `<span class="text-orange-600"> | ${jogo.origem}</span>` : ''}
                    </div>
                `;
                
                lista.appendChild(jogoDiv);
            });
        }

        function removerJogo(id) {
            showCustomConfirm('Tem certeza que deseja excluir este jogo?', () => {
                jogosAdicionados = jogosAdicionados.filter(jogo => jogo.id !== id);
                atualizarVisualizacaoJogos();
                atualizarCustoTotal();
            });
        }

        function limparTodos() {
            if (jogosAdicionados.length === 0) return;
            
            showCustomConfirm('Tem certeza que deseja remover todos os jogos?', () => {
                jogosAdicionados = [];
                atualizarVisualizacaoJogos();
                atualizarCustoTotal();
            });
        }

        function atualizarCustoTotal() {
            const total = jogosAdicionados.reduce((sum, jogo) => sum + jogo.custo, 0);
            document.getElementById('custoTotal').textContent = formatarMoeda(total);
            document.getElementById('totalJogos').textContent = jogosAdicionados.length;
        }

        function atualizarValorAposta() {
            const valor = parseFloat(document.getElementById('valorAposta').value);
            if (valor > 0) {
                valorAposta = valor;
                document.getElementById('valor50numeros').textContent = formatarMoeda(valor);
                document.getElementById('ultimaAtualizacao').textContent = new Date().toLocaleString('pt-BR');
            }
        }

        // An√°lise de Padr√µes - SE√á√ÉO 3
        function carregarAnalisesPadroes() {
            if (!ultimoResultado) return;
            
            // Carregar padr√µes do √∫ltimo concurso
            carregarPadroesUltimoConcurso();
            
            // Carregar an√°lise de n√∫meros ausentes
            carregarNumerosAusentes();
        }

        function carregarPadroesUltimoConcurso() {
            const numeros = ultimoResultado.listaDezenas.map(n => parseInt(n));
            const ordemSorteio = ultimoResultado.dezenasSorteadasOrdemSorteio.map(n => parseInt(n));
            
            // ========== ORDEM CRESCENTE ==========
            const numerosCrescente = document.getElementById('numerosCrescente');
            numerosCrescente.innerHTML = '';
            numeros.forEach(num => {
                const span = document.createElement('span');
                span.className = 'numero-palpite';
                span.textContent = num.toString().padStart(2, '0');
                numerosCrescente.appendChild(span);
            });
            
            // Calcular d√≠gitos √∫nicos e padr√£o das dezenas (ordem crescente)
            const digitosUnicosCrescente = calcularDigitosUnicos(numeros);
            const padraoDezenasCresc = numeros.map(num => Math.floor(num / 10));
            const padraoTextoCresc = `[${padraoDezenasCresc.join(' ')}] ${digitosUnicosCrescente}d`;
            
            document.getElementById('resumoSorteados').innerHTML = `
                <div class="text-xl font-mono font-bold text-orange-600 bg-white p-3 rounded border-2 border-orange-300 mb-2">${padraoTextoCresc}</div>
                <div>${numeros.length} n√∫meros sorteados | D√≠gitos √∫nicos: ${digitosUnicosCrescente}</div>
            `;
            
            // ========== ORDEM DE SORTEIO ==========
            const numerosSorteio = document.getElementById('numerosSorteio');
            numerosSorteio.innerHTML = '';
            ordemSorteio.forEach(num => {
                const span = document.createElement('span');
                span.className = 'numero-palpite';
                span.textContent = num.toString().padStart(2, '0');
                numerosSorteio.appendChild(span);
            });
            
            // Calcular d√≠gitos √∫nicos e padr√£o das dezenas (ordem de sorteio)
            const digitosUnicosSorteio = calcularDigitosUnicos(ordemSorteio);
            const padraoDecenasSorteio = ordemSorteio.map(num => Math.floor(num / 10));
            const padraoTextoSorteio = `[${padraoDecenasSorteio.join(' ')}] ${digitosUnicosSorteio}d`;
            
            document.getElementById('resumoSorteio').innerHTML = `
                <div class="text-xl font-mono font-bold text-blue-600 bg-white p-3 rounded border-2 border-blue-300 mb-2">${padraoTextoSorteio}</div>
                <div>Ordem original do sorteio | D√≠gitos √∫nicos: ${digitosUnicosSorteio}</div>
            `;
        }

        function calcularDigitosUnicos(numeros) {
            const digitosSet = new Set();
            numeros.forEach(num => {
                const digitos = num.toString().padStart(2, '0').split('');
                digitos.forEach(digito => digitosSet.add(digito));
            });
            return digitosSet.size;
        }

        function carregarNumerosAusentes() {
            const quantidade = parseInt(document.getElementById('analisarJogos').value);
            const todosNumeros = Array.from({length: 100}, (_, i) => i);
            
            // Simular an√°lise hist√≥rica
            const numerosUsados = new Set();
            
            // Adicionar n√∫meros do √∫ltimo sorteio
            ultimoResultado.listaDezenas.forEach(num => {
                numerosUsados.add(parseInt(num));
            });
            
            // Simular jogos anteriores
            for (let i = 0; i < quantidade - 1; i++) {
                const jogosSimulados = gerarJogoSimuladoHistorico();
                jogosSimulados.forEach(num => numerosUsados.add(num));
            }
            
            const numerosAusentes = todosNumeros.filter(num => !numerosUsados.has(num));
            
            // Dividir em quadrantes
            const q1 = numerosAusentes.filter(n => n >= 0 && n <= 24);
            const q2 = numerosAusentes.filter(n => n >= 25 && n <= 49);
            const q3 = numerosAusentes.filter(n => n >= 50 && n <= 74);
            const q4 = numerosAusentes.filter(n => n >= 75 && n <= 99);
            
            document.getElementById('numerosQ1').textContent = 
                q1.length > 0 ? q1.map(n => n.toString().padStart(2, '0')).join(', ') : 'Todos sa√≠ram';
            document.getElementById('numerosQ2').textContent = 
                q2.length > 0 ? q2.map(n => n.toString().padStart(2, '0')).join(', ') : 'Todos sa√≠ram';
            document.getElementById('numerosQ3').textContent = 
                q3.length > 0 ? q3.map(n => n.toString().padStart(2, '0')).join(', ') : 'Todos sa√≠ram';
            document.getElementById('numerosQ4').textContent = 
                q4.length > 0 ? q4.map(n => n.toString().padStart(2, '0')).join(', ') : 'Todos sa√≠ram';
            
            const total = numerosAusentes.length;
            const porcentagem = ((total / 100) * 100).toFixed(1);
            
            document.getElementById('resumoAnalise').textContent = 
                `${total} n√∫meros n√£o sa√≠ram nos √∫ltimos ${quantidade} jogos (${porcentagem}% do total). Q1: ${q1.length} | Q2: ${q2.length} | Q3: ${q3.length} | Q4: ${q4.length}`;
        }

        function gerarJogoSimuladoHistorico() {
            const numeros = [];
            while (numeros.length < 20) {
                const num = Math.floor(Math.random() * 100);
                if (!numeros.includes(num)) {
                    numeros.push(num);
                }
            }
            return numeros;
        }

        // Downloads
        function downloadTXT() {
            if (jogosAdicionados.length === 0) {
                showCustomAlert('‚ö†Ô∏è Sem Jogos', 'Adicione pelo menos um jogo antes de fazer o download!');
                return;
            }
            
            let txt = '';
            jogosAdicionados.forEach((jogo, index) => {
                txt += jogo.numeros.map(n => n.toString().padStart(2, '0')).join(' ');
                if (index < jogosAdicionados.length - 1) {
                    txt += '\n';
                }
            });
            baixarArquivo(txt, 'lotomania-jogos.txt', 'text/plain');
        }

        function downloadHTML() {
            if (jogosAdicionados.length === 0) {
                showCustomAlert('‚ö†Ô∏è Sem Jogos', 'Adicione pelo menos um jogo antes de fazer o download!');
                return;
            }
            
            const total = jogosAdicionados.reduce((sum, jogo) => sum + jogo.custo, 0);
            const data = new Date().toLocaleDateString('pt-BR');
            
            let html = `<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Lotomania - Meus Jogos</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { text-align: center; margin-bottom: 30px; color: #E68527; }
        .jogo { margin: 10px 0; padding: 15px; border: 2px solid #E68527; border-radius: 8px; }
        .numero { display: inline-block; width: 30px; height: 30px; background: #E68527; color: white; 
                 border-radius: 50%; text-align: center; line-height: 30px; margin: 1px; font-weight: bold; font-size: 11px; }
        .total { text-align: center; margin-top: 20px; font-size: 18px; font-weight: bold; color: #E68527; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üü† LOTOMANIA - MEUS JOGOS</h1>
        <p>Gerado em: ${data}</p>
    </div>`;
            
            jogosAdicionados.forEach((jogo, index) => {
                html += `
    <div class="jogo">
        <h3>Jogo ${index + 1} - 50 n√∫meros - ${formatarMoeda(jogo.custo)}</h3>
        <div>
            ${jogo.numeros.map(num => `<span class="numero">${num.toString().padStart(2, '0')}</span>`).join('')}
        </div>
        <div style="font-size: 12px; color: #666; margin-top: 5px;">
            50 n√∫meros selecionados ${jogo.apostaEspelho ? ' | ü™û Aposta Espelho' : ''}
            ${jogo.origem ? ` | Origem: ${jogo.origem}` : ''}
        </div>
    </div>`;
            });
            
            html += `
    <div class="total">
        Total: ${jogosAdicionados.length} jogo(s) - ${formatarMoeda(total)}
    </div>
</body>
</html>`;
            
            baixarArquivo(html, 'lotomania-jogos.html', 'text/html');
        }

        function downloadXLSX() {
            if (jogosAdicionados.length === 0) {
                showCustomAlert('‚ö†Ô∏è Sem Jogos', 'Adicione pelo menos um jogo antes de fazer o download!');
                return;
            }
            
            const dados = [
                ['Jogo', 'N√∫meros', 'Custo', 'Aposta Espelho', 'Origem']
            ];
            
            jogosAdicionados.forEach((jogo, index) => {
                dados.push([
                    `Jogo ${index + 1}`,
                    jogo.numeros.map(n => n.toString().padStart(2, '0')).join(' - '),
                    jogo.custo,
                    jogo.apostaEspelho ? 'Sim' : 'N√£o',
                    jogo.origem || 'Manual'
                ]);
            });
            
            const total = jogosAdicionados.reduce((sum, jogo) => sum + jogo.custo, 0);
            dados.push(['', 'TOTAL:', total, '', '']);
            
            const ws = XLSX.utils.aoa_to_sheet(dados);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Lotomania');
            XLSX.writeFile(wb, 'lotomania-jogos.xlsx');
        }

        function baixarArquivo(conteudo, nomeArquivo, tipoMime) {
            const blob = new Blob([conteudo], { type: tipoMime });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = nomeArquivo;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // Modais customizados
        function showCustomAlert(titulo, mensagem) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <h3 class="font-bold text-lotomania mb-2">${titulo}</h3>
                    <p class="text-gray-700 mb-4">${mensagem}</p>
                    <div class="flex justify-end">
                        <button class="px-4 py-2 bg-blue-500 text-white hover:bg-blue-600 rounded" onclick="this.closest('.fixed').remove()">OK</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function showCustomConfirm(message, onConfirm) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            
            const modalContent = document.createElement('div');
            modalContent.className = 'bg-white p-6 rounded-lg shadow-lg max-w-sm w-full mx-4';
            
            const messageEl = document.createElement('p');
            messageEl.className = 'text-gray-700 mb-4';
            messageEl.textContent = message;
            
            const buttonsDiv = document.createElement('div');
            buttonsDiv.className = 'flex justify-end space-x-3';
            
            const cancelBtn = document.createElement('button');
            cancelBtn.className = 'px-4 py-2 text-gray-600 hover:bg-gray-100 rounded';
            cancelBtn.textContent = 'Cancelar';
            cancelBtn.onclick = () => modal.remove();
            
            const confirmBtn = document.createElement('button');
            confirmBtn.className = 'px-4 py-2 bg-red-500 text-white hover:bg-red-600 rounded';
            confirmBtn.textContent = 'Confirmar';
            confirmBtn.onclick = () => {
                modal.remove();
                onConfirm();
            };
            
            buttonsDiv.appendChild(cancelBtn);
            buttonsDiv.appendChild(confirmBtn);
            modalContent.appendChild(messageEl);
            modalContent.appendChild(buttonsDiv);
            modal.appendChild(modalContent);
            document.body.appendChild(modal);
        }

        function formatarMoeda(valor) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(valor);
        }

        // üî• DRAG & DROP FUNCIONAL
        let draggedNumber = null;

        function handleDragStart(e) {
            draggedNumber = parseInt(e.target.dataset.numero);
            e.target.style.opacity = '0.5';
        }

        function handleDragEnd(e) {
            e.target.style.opacity = '';
            draggedNumber = null;
        }

        function handleDragOver(e) {
            e.preventDefault();
            const dropZone = document.getElementById('dropZone');
            dropZone.classList.add('drag-over');
        }

        function handleDragEnter(e) {
            e.preventDefault();
        }

        function handleDragLeave(e) {
            const dropZone = document.getElementById('dropZone');
            dropZone.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            const dropZone = document.getElementById('dropZone');
            dropZone.classList.remove('drag-over');
            
            if (draggedNumber !== null && !numerosSelecionados.includes(draggedNumber) && numerosSelecionados.length < 50) {
                toggleNumero(draggedNumber);
            }
        }

        // Fun√ß√£o para mostrar aposta espelho
        function mostrarApostaEspelho() {
            // Remover classe espelho de todos os bot√µes
            document.querySelectorAll('.numero-btn').forEach(btn => {
                btn.classList.remove('espelho');
            });
            
            // Calcular n√∫meros espelho (n√£o selecionados)
            const numerosEspelho = [];
            for (let i = 0; i <= 99; i++) {
                if (!numerosSelecionados.includes(i)) {
                    numerosEspelho.push(i);
                }
            }
            
            // Marcar n√∫meros espelho no grid
            numerosEspelho.forEach(numero => {
                const btn = document.querySelector(`[data-numero="${numero}"]`);
                if (btn) {
                    btn.classList.add('espelho');
                }
            });
            
            showCustomAlert('ü™û Aposta Espelho', 
                `Os n√∫meros em ROXO (ü™û) s√£o sua aposta espelho!\n\n` +
                `Total: ${numerosEspelho.length} n√∫meros\n` +
                `N√∫meros espelho: ${numerosEspelho.slice(0, 10).map(n => n.toString().padStart(2, '0')).join(', ')}...`
            );
            
            // Remover marca√ß√£o espelho ap√≥s 5 segundos
            setTimeout(() => {
                document.querySelectorAll('.numero-btn').forEach(btn => {
                    btn.classList.remove('espelho');
                });
            }, 5000);
        }

        // Fun√ß√£o para alternar para aposta espelho
        function alternarParaEspelho() {
            if (numerosSelecionados.length === 0) {
                showCustomAlert('‚ö†Ô∏è Aviso', 'Selecione alguns n√∫meros primeiro para poder alternar!');
                return;
            }
            
            showCustomConfirm(
                `üîÑ Alternar para Aposta Espelho\n\nIsto ir√°:\n` +
                `‚úó Desmarcar os ${numerosSelecionados.length} n√∫meros atuais\n` +
                `‚úì Selecionar os outros ${100 - numerosSelecionados.length} n√∫meros\n\n` +
                `Deseja continuar?`,
                () => {
                    // Armazenar n√∫meros atuais
                    const numerosAtuais = [...numerosSelecionados];
                    
                    // Limpar sele√ß√£o
                    limparJogo();
                    
                    // Selecionar n√∫meros espelho
                    for (let i = 0; i <= 99; i++) {
                        if (!numerosAtuais.includes(i) && numerosSelecionados.length < 50) {
                            numerosSelecionados.push(i);
                            const btn = document.querySelector(`[data-numero="${i}"]`);
                            if (btn) btn.classList.add('selecionado');
                        }
                    }
                    
                    atualizarVisualizacaoDropArea();
                    atualizarContadorNumeros();
                    validarBotaoAdicionar();
                    
                    showCustomAlert('‚úÖ Sucesso', 'Aposta espelho aplicada com sucesso!');
                }
            );
        }

        function configurarEventListeners() {
            document.getElementById('atualizarValor').addEventListener('click', atualizarValorAposta);
            document.getElementById('limparJogo').addEventListener('click', limparJogo);
            document.getElementById('randomizarJogo').addEventListener('click', randomizarJogo);
            document.getElementById('completarAutomatico').addEventListener('click', completarAutomatico);
            document.getElementById('adicionarJogo').addEventListener('click', adicionarJogo);
            document.getElementById('processarManual').addEventListener('click', processarManual);
            document.getElementById('gerarMinimalistas').addEventListener('click', gerarMinimalistas);
            document.getElementById('adicionarTodosGerados').addEventListener('click', adicionarTodosGerados);
            document.getElementById('mostrarOrdemCrescente').addEventListener('change', atualizarVisualizacaoJogos);
            document.getElementById('permitirNumerosSorteados').addEventListener('change', () => {
                atualizarEstadoNumerosSorteados();
                // Se permitir n√∫meros sorteados e n√£o temos 50 n√∫meros, completar automaticamente
                if (document.getElementById('permitirNumerosSorteados').checked && numerosSelecionados.length < 50) {
                    completarAutomatico();
                }
            });
            document.getElementById('analisarJogos').addEventListener('change', carregarNumerosAusentes);
            document.getElementById('limparTodos').addEventListener('click', limparTodos);
            document.getElementById('downloadHTML').addEventListener('click', downloadHTML);
            document.getElementById('downloadTXT').addEventListener('click', downloadTXT);
            document.getElementById('downloadXLSX').addEventListener('click', downloadXLSX);
            
            // Bot√µes de aposta espelho
            document.getElementById('mostrarApostaEspelho').addEventListener('click', mostrarApostaEspelho);
            document.getElementById('alternarParaEspelho').addEventListener('click', alternarParaEspelho);

            // üî• Configurar Drop Zone para drag & drop
            const dropZone = document.getElementById('dropZone');
            dropZone.addEventListener('dragover', handleDragOver);
            dropZone.addEventListener('dragenter', handleDragEnter);
            dropZone.addEventListener('dragleave', handleDragLeave);
            dropZone.addEventListener('drop', handleDrop);
        }
    </script>
</body>
</html>